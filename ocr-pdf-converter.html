<form id="u" enctype="multipart/form-data">
  <input type="file" name="file" id="file" accept="application/pdf,image/*">
  <button type="submit">Upload & Convert</button>
</form>
<script>
document.getElementById('u').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const f = document.getElementById('file').files[0];
  if(!f){alert('Select file'); return;}
  const fd = new FormData(); fd.append('file', f);
  const r = await fetch('/api/convert/pdf-to-docx', { method:'POST', body: fd });
  if (!r.ok) { alert('Conversion failed'); return; }
  const blob = await r.blob();
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url;
  a.download = f.name.replace(/\.[^.]+$/, '') + '.docx';
  a.click();
  URL.revokeObjectURL(url);
});
</script>
